{
  "version": 3,
  "file": "aesgcm256.js",
  "sourceRoot": "",
  "sources": [
    "coffeescripts/aesgcm256.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "crypto = require \"crypto\"\ncommon = require \"./common\"\n\nmodule.exports =\n  encrypt: (text, secret) =>\n    new Promise (resolve, reject) =>\n      masterKey = null\n\n      # We will presume that the secret is cryptographically strong\n      if Buffer.isBuffer secret\n        masterKey = secret\n      else if typeof secret is \"string\"\n        masterKey = Buffer.from secret\n      else\n        return reject \"secret should be either a String or Buffer. Found '#{typeof secret}'.\"\n\n      salt = await common.randomString 64\n      iv = await common.randomString 16\n\n      crypto.pbkdf2 masterKey, salt, 10000, 32, \"sha512\", (err, derivedKey) =>\n        if err?\n          return reject err\n\n        cipher = crypto.createCipheriv \"aes-256-gcm\", derivedKey, iv\n        cipherText = Buffer.concat [cipher.update(text, \"utf8\"), cipher.final()]\n        authTag = cipher.getAuthTag()\n        resolve Buffer.concat [salt, iv, authTag, cipherText]\n\n  decrypt: (cipherTextBuffer, secret) =>\n    new Promise (resolve, reject) =>\n      masterKey = null\n\n      if false is Buffer.isBuffer cipherTextBuffer\n        return reject \"cipherTextBuffer should be of type Buffer. Found '#{typeof cipherTextBuffer}'.\"\n\n      if Buffer.isBuffer secret\n        masterKey = secret\n      else if typeof secret is \"string\"\n        masterKey = Buffer.from secret\n      else\n        return reject \"secret should be either a String or Buffer. Found '#{typeof secret}'.\"\n\n      salt = cipherTextBuffer.slice 0, 64\n      iv = cipherTextBuffer.slice 64, 80\n      authTag = cipherTextBuffer.slice 80, 96\n      cipherText = cipherTextBuffer.slice 96\n      crypto.pbkdf2 masterKey, salt, 10000, 32, \"sha512\", (err, derivedKey) =>\n        cipher = crypto.createDecipheriv \"aes-256-gcm\", derivedKey, iv\n        cipher.setAuthTag authTag\n        text = cipher.update(cipherText, \"binary\", \"utf8\") + cipher.final(\"utf8\")\n        resolve text\n"
  ]
}